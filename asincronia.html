<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        /*
        console.log("inicio")
        setTimeout(() => {
            console.log('esto se ejcuta una vez')
        }, 1000)

//        setInterval(() => {
//            console.log('se ejecuta cada rato')
//        }, 1000)

        let tempo = setTimeout(() => {
            console.log(new Date().toLocaleTimeString())
        }, 1000)
        
        clearTimeout(tempo);
        console.log('despues del clearTimeout')

        let interval = setInterval(() => {
            console.log('se ejecuta cada rato')
        }, 1000)
        clearInterval(interval)
        console.log('despues del clearInterval');

        */

        /*Código sincrono bloqueante*/
        /*
        (() =>{
            console.log('Codigo sincrono');
            console.log('Inicio');

            function dos() {
                console.log('dos');
            }

            function uno(){
                console.log("Uno")
                dos();
                console.log("tres")
            }

            uno();

            console.log("fin");
        })();
        */

        /*Código Asincrono NO bloqueante*/

        /*
        (() =>{
            console.log('Codigo Asincrono');
            console.log('Inicio');

            function dos() {
                setTimeout(function(){
                    console.log('dos');
                }, 1000);
            }

            function uno(){
                setTimeout(function(){
                    console.log("Uno")
                }, 0);
                dos();
                console.log("tres")
            }

            uno();

            console.log("fin");
        })();
        */
        /*
        Callback: Mecanismo para controla sincronia
        */

        /*
        function cuadradoCallBack(value, callback) {
            setTimeout(() => {
                callback(value, value*value)
            }, 0 | Math.random() * 1000);
        }

        cuadradoCallBack(0, (value, result) => {
            console.log('inicia callback');
            console.log('calback', value, result)
            cuadradoCallBack(1, (value, result) => {
                console.log('calback', value, result)
                cuadradoCallBack(2, (value, result) => {
                    console.log('calback', value, result)
                    cuadradoCallBack(3, (value, result) => {
                        console.log('calback', value, result)
                    });
                });
            });
        });
        */
        /*
        Promesas, la podemos ver como un if else
        si se cumple retorna resolve
        si falla es reject
        */

        
        function cuadradoPromise(value) {
            if (typeof value !== "number") return Promise.reject(
                'El valor ' + value + ' no es un numero'
            );

            return new Promise((resolve, reject) => {
                setTimeout(() => {
                resolve({
                    value,
                    result: value * value
                })
            }, 0 | Math.random() * 1000);
            });
        }

        /*
        cuadradoPromise(0)
            .then((obj) => {
                console.log('Inicia promesa')
                console.log(obj)
                return cuadradoPromise(1);
            })
            .then((obj) => {
                console.log(obj)
                return cuadradoPromise(2);
            })
            .then((obj) => {
                console.log(obj)
                return cuadradoPromise("3");
            })
            .then((obj) => {
                console.log(obj)
                return cuadradoPromise(4);
            })
            .then((obj) => {
                console.log(obj)
                return cuadradoPromise(5);
            })
            .then((obj) => {
                console.log(obj)
                console.log('fin de la promesa')
            })
            .catch(err => console.error(err));
        */

        /*
        Async: Define un metodo asincrono
        await: dice que hasta que esta tarea asincrona finalice pasa a la siguiente linea
        */
            async function functionAsincronaDeclarada(){
                try {
                    console.log('Inicio de funcion asincrona')
                    let obj = await cuadradoPromise(0);
                    console.log('Async function', obj.value, obj.result)
                    obj = await cuadradoPromise(1);
                    console.log('Async function', obj.value, obj.result)
                    obj = await cuadradoPromise(2);
                    console.log('Async function', obj.value, obj.result)
                    obj = await cuadradoPromise("3");
                    console.log('Async function', obj.value, obj.result)
                    obj = await cuadradoPromise(4);
                    console.log('Async function', obj.value, obj.result)
                    obj = await cuadradoPromise(5);
                    console.log('Async function', obj.value, obj.result)
                    console.log('Fin Async function')
                }
                catch(err){
                    console.error(err)

                }
            }
            
            functionAsincronaDeclarada();

            const functionAsincronaExpresada = async() => {

                try {
                    console.log('Inicio de funcion asincrona')
                    let obj = await cuadradoPromise(6);
                    console.log('Async function', obj.value, obj.result)
                    obj = await cuadradoPromise(7);
                    console.log('Async function', obj.value, obj.result)
                    obj = await cuadradoPromise(8);
                    console.log('Async function', obj.value, obj.result)
                    obj = await cuadradoPromise("9");
                    console.log('Async function', obj.value, obj.result)
                    obj = await cuadradoPromise(10);
                    console.log('Async function', obj.value, obj.result)
                    obj = await cuadradoPromise(11);
                    console.log('Async function', obj.value, obj.result)
                    console.log('Fin Async function')
                }
                catch(err){
                    console.error(err)

                }
            }

            functionAsincronaExpresada()
    </script>
</body>
</html>